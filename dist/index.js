"use strict";function t(t,r){return o(t,r).shift()}function r(t,r){return new Array(t).fill(r)}function e(t){return o(t).reverse()}function n(t,r){const e=(r%t.length+t.length)%t.length;return t.slice(e).concat(t.slice(0,e))}function o(t,r,e){return t.slice(r,e)}function s(t,r,e,...n){return t.splice(r,e,...n)}function c(t){return f(i(t))}function i(t){const e=Math.sqrt(t.length);return r(e).map((r,n)=>{const s=n*e;return o(t,s,s+e)})}function a(t,e){return r(e).map((r,e)=>({data:null,originalIndex:e,value:t}))}function u(t){return l(f(t))}function l(t){return t.reduce((t,r)=>t.concat(r),[])}function f(t){return t[0].map((r,e)=>t.map(t=>t[e]))}function h(t,r){const{depth:e,wide:n}=t;for(let t=e,o=n?0:e-1;t>o;t--)r(t,-t,t-1)}function p(t,r){return-1===r?l(e(c(t))):2===r?e(t):u(e(i(t)))}function F(t){return{U:{r:i(t.U),c:c(t.U)},L:{r:i(t.L),c:c(t.L)},F:{r:i(t.F),c:c(t.F)},R:{r:i(t.R),c:c(t.R)},B:{r:i(t.B),c:c(t.B)},D:{r:i(t.D),c:c(t.D)}}}function B(t){return t}function D(t){return t.trim()}Object.defineProperty(exports,"__esModule",{value:!0});exports.Cube=class extends class{constructor(t){this.options=t,this.reset()}turn(t){t.split(" ").map(D).filter(B).map(t=>this.parseTurn(t)).forEach(t=>this.applyTurn(t))}}{constructor(t){if(!Number.isInteger(t.size))throw new Error("Cube size must be an integer");if(t.size<2)throw new Error("Cube size must be two or greater");super(t)}applyTurn(r){const{target:n}=r;if("X"===n)this.state=function({U:t,L:r,F:n,R:s,B:c,D:i},{rotation:a}){return-1===a?{U:e(c),L:p(r,1),F:o(t),R:p(s,-1),B:e(i),D:o(n)}:2===a?{U:o(i),L:p(r,2),F:e(c),R:p(s,2),B:e(n),D:o(t)}:{U:o(n),L:p(r,-1),F:o(i),R:p(s,1),B:e(t),D:e(c)}}(this.state,r);else if("Y"===n)this.state=function({U:t,L:r,F:e,R:n,B:s,D:c},{rotation:i}){return-1===i?{U:p(t,-1),L:o(s),F:o(r),R:o(e),B:o(n),D:p(c,1)}:2===i?{U:p(t,2),L:o(n),F:o(s),R:o(r),B:o(e),D:p(c,2)}:{U:p(t,1),L:o(e),F:o(n),R:o(s),B:o(r),D:p(c,-1)}}(this.state,r);else if("Z"===n)this.state=function({U:t,L:r,F:n,R:o,B:s,D:c},{rotation:i}){return-1===i?{U:p(o,-1),L:p(t,-1),F:p(n,-1),R:p(c,-1),B:p(s,1),D:p(r,-1)}:2===i?{U:e(c),L:e(o),F:p(n,2),R:e(r),B:p(s,2),D:e(t)}:{U:p(r,1),L:p(c,1),F:p(n,1),R:p(t,1),B:p(s,-1),D:p(o,1)}}(this.state,r);else{const n=function(t){const{target:r}=t;switch(r){case"U":return"U";case"L":return"L";case"F":return"F";case"R":return"R";case"B":return"B";case"D":return"D"}}(r);switch((1===r.depth||r.wide)&&(this.state[n]=p(this.state[n],r.rotation)),n){case"U":!function(r,e){const n=F(r);h(e,(o,c,i)=>{const a=t(n.B.r,i),u=t(n.R.r,i),f=t(n.F.r,i),h=t(n.L.r,i);let p,F,B,D;2===e.rotation?(p=f,F=h,B=a,D=u):-1===e.rotation?(p=u,F=f,B=h,D=a):(p=h,F=a,B=u,D=f),s(n.B.r,i,1,p),s(n.R.r,i,1,F),s(n.F.r,i,1,B),s(n.L.r,i,1,D),r.B=l(n.B.r),r.R=l(n.R.r),r.F=l(n.F.r),r.L=l(n.L.r)})}(this.state,r);break;case"L":!function(r,n){const o=F(r);h(n,(c,i,a)=>{const l=t(o.U.c,a),f=t(o.F.c,a),h=t(o.D.c,a),p=t(o.B.c,i);let F,B,D,L;2===n.rotation?(F=h,B=e(p),D=l,L=e(f)):-1===n.rotation?(F=f,B=h,D=e(p),L=e(l)):(F=e(p),B=l,D=f,L=e(h)),s(o.U.c,a,1,F),s(o.F.c,a,1,B),s(o.D.c,a,1,D),s(o.B.c,i,1,L),r.U=u(o.U.c),r.F=u(o.F.c),r.D=u(o.D.c),r.B=u(o.B.c)})}(this.state,r);break;case"F":!function(r,n){const o=F(r);h(n,(c,i,a)=>{const f=t(o.U.r,i),h=t(o.R.c,a),p=t(o.D.r,a),F=t(o.L.c,i);let B,D,L,R;2===n.rotation?(B=e(p),D=e(F),L=e(f),R=e(h)):-1===n.rotation?(B=h,D=e(p),L=F,R=e(f)):(B=e(F),D=f,L=e(h),R=p),s(o.U.r,i,1,B),s(o.R.c,a,1,D),s(o.D.r,a,1,L),s(o.L.c,i,1,R),r.U=l(o.U.r),r.R=u(o.R.c),r.D=l(o.D.r),r.L=u(o.L.c)})}(this.state,r);break;case"R":!function(r,n){const o=F(r);h(n,(c,i,a)=>{const l=t(o.U.c,i),f=t(o.B.c,a),h=t(o.D.c,i),p=t(o.F.c,i);let F,B,D,L;2===n.rotation?(F=h,B=e(p),D=l,L=e(f)):-1===n.rotation?(F=e(f),B=e(h),D=p,L=l):(F=p,B=e(l),D=e(f),L=h),s(o.U.c,i,1,F),s(o.B.c,a,1,B),s(o.D.c,i,1,D),s(o.F.c,i,1,L),r.U=u(o.U.c),r.B=u(o.B.c),r.D=u(o.D.c),r.F=u(o.F.c)})}(this.state,r);break;case"B":!function(r,n){const o=F(r);h(n,(c,i,a)=>{const f=t(o.U.r,a),h=t(o.L.c,a),p=t(o.D.r,i),F=t(o.R.c,i);let B,D,L,R;2===n.rotation?(B=e(p),D=e(F),L=e(f),R=e(h)):-1===n.rotation?(B=e(h),D=p,L=e(F),R=f):(B=F,D=e(f),L=h,R=e(p)),s(o.U.r,c-1,1,B),s(o.L.c,c-1,1,D),s(o.D.r,i,1,L),s(o.R.c,i,1,R),r.U=l(o.U.r),r.L=u(o.L.c),r.D=l(o.D.r),r.R=u(o.R.c)})}(this.state,r);break;case"D":!function(r,e){const n=F(r);h(e,(o,c)=>{const i=t(n.F.r,c),a=t(n.R.r,c),u=t(n.B.r,c),f=t(n.L.r,c);let h,p,F,B;2===e.rotation?(h=u,p=f,F=i,B=a):-1===e.rotation?(h=a,p=u,F=f,B=i):(h=f,p=i,F=a,B=u),s(n.F.r,c,1,h),s(n.R.r,c,1,p),s(n.B.r,c,1,F),s(n.L.r,c,1,B),r.F=l(n.F.r),r.R=l(n.R.r),r.B=l(n.B.r),r.L=l(n.L.r)})}(this.state,r)}}}isSolved(){return!1}parseTurn(t){return function(t){const r=t.match(/^(\d)*([ulfrbdxyzULFRBDXYZ]){1}(w)*(['-2])*$/);if(null===r)throw new Error(`Invalid turn: ${t}`);const e=r[4],n=r[2],o=Boolean(r[3]);let s=r[1]?parseInt(r[1],10):1;o&&(s=Math.max(2,s));let c=1;return"-"===e||"'"===e?c=-1:"2"===e&&(c=2),{depth:s,rotation:c,target:n,wide:o}}(t)}reset(){const t=Math.pow(this.options.size,2);this.state={U:a(0,t),L:a(1,t),F:a(2,t),R:a(3,t),B:a(4,t),D:a(5,t)}}},exports.createFace=function(t,r){if(!Number.isInteger(t)||t<3)throw new Error("Polygon sides must be an integer of 3 or greater");if(!Number.isInteger(r)||r<2)throw new Error("Polygon layers must be an integer of 2 or greater");if(3===t)throw new Error("Pyramids are not implemented yet");const e=[];for(let n=0,o=Math.floor(r/2);n<o;n++){const o=(r-2*n-1)*t;for(let t=0;t<o;t++)e.push({center:!1,currentIndex:t,depth:n,meta:{},originalIndex:t})}return r%2&&e.push({center:!0,currentIndex:0,depth:Math.floor(r/2),meta:{},originalIndex:0}),{layers:r,sides:t,stickers:e}},exports.extractSlice=function(t,r,e){if(!Number.isInteger(r)||r<0)throw new Error("Slice depth must be a positive integer");if(!Number.isInteger(e)||e<0)throw new Error("Slice angle must be a positive integer");return[]},exports.rotateFace=function(t,r){if(!Number.isInteger(r))throw new Error("Face rotations must be an integer");const e=[];r%=t.sides;for(let o=0,s=Math.floor(t.layers/2);o<=s;o++){const s=t.stickers.filter(t=>t.depth===o);if(r&&s.length>1){const o=s.length/t.sides*-r;o&&e.push(...n(s,o))}else e.push(...s)}return Object.assign(Object.assign({},t),{stickers:e})};
