var Twister=function(t){"use strict";function r(t,r){return Math.floor(Math.random()*(r-t+1))+t}function e(t,r){return i(t,r).shift()}function n(t,r){return new Array(t).fill(r)}function s(t){return t[r(0,t.length-1)]}function o(t){return i(t).reverse()}function i(t,r,e){return t.slice(r,e)}function c(t,r,e,...n){return t.splice(r,e,...n)}function a(t){return B(u(t))}function u(t){const r=Math.sqrt(t.length);return n(r).map((e,n)=>{const s=n*r;return i(t,s,s+r)})}function h(t,r){return n(r).map((r,e)=>({data:null,originalIndex:e,value:t}))}function f(t){const r=t[0].value;for(let e=1;e<t.length;e++)if(t[e].value!==r)return!1;return!0}function D(t){return l(B(t))}function l(t){return t.reduce((t,r)=>t.concat(r),[])}function B(t){return t[0].map((r,e)=>t.map(t=>t[e]))}function L(t,r){const{depth:e,wide:n}=t;for(let t=e,s=n?0:e-1;t>s;t--)r(t,-t,t-1)}function R(t,r){return-1===r?l(o(a(t))):2===r?o(t):D(o(u(t)))}function U(t){return{U:{r:u(t.U),c:a(t.U)},L:{r:u(t.L),c:a(t.L)},F:{r:u(t.F),c:a(t.F)},R:{r:u(t.R),c:a(t.R)},B:{r:u(t.B),c:a(t.B)},D:{r:u(t.D),c:a(t.D)}}}function F(t){return t}function p(t){return t.trim()}class d{constructor(t){this.options=t,this.reset()}scramble(t){this.reset(),this.turn(this.generateScramble(t))}turn(t){t.split(" ").map(p).filter(F).map(t=>this.parseTurn(t)).forEach(t=>this.applyTurn(t))}}return t.Cube=class extends d{constructor(t){if(!Number.isInteger(t.size))throw new Error("Cube size must be an integer");if(t.size<2)throw new Error("Cube size must be two or greater");super(t)}applyTurn(t){const{target:r}=t;if("X"===r)this.state=function({U:t,L:r,F:e,R:n,B:s,D:c},{rotation:a}){return-1===a?{U:o(s),L:R(r,1),F:i(t),R:R(n,-1),B:o(c),D:i(e)}:2===a?{U:i(c),L:R(r,2),F:o(s),R:R(n,2),B:o(e),D:i(t)}:{U:i(e),L:R(r,-1),F:i(c),R:R(n,1),B:o(t),D:o(s)}}(this.state,t);else if("Y"===r)this.state=function({U:t,L:r,F:e,R:n,B:s,D:o},{rotation:c}){return-1===c?{U:R(t,-1),L:i(s),F:i(r),R:i(e),B:i(n),D:R(o,1)}:2===c?{U:R(t,2),L:i(n),F:i(s),R:i(r),B:i(e),D:R(o,2)}:{U:R(t,1),L:i(e),F:i(n),R:i(s),B:i(r),D:R(o,-1)}}(this.state,t);else if("Z"===r)this.state=function({U:t,L:r,F:e,R:n,B:s,D:i},{rotation:c}){return-1===c?{U:R(n,-1),L:R(t,-1),F:R(e,-1),R:R(i,-1),B:R(s,1),D:R(r,-1)}:2===c?{U:o(i),L:o(n),F:R(e,2),R:o(r),B:R(s,2),D:o(t)}:{U:R(r,1),L:R(i,1),F:R(e,1),R:R(t,1),B:R(s,-1),D:R(n,1)}}(this.state,t);else{const r=function(t){const{target:r}=t;switch(r){case"U":return"U";case"L":return"L";case"F":return"F";case"R":return"R";case"B":return"B";case"D":return"D"}}(t);if((1===t.depth||t.wide)&&(this.state[r]=R(this.state[r],t.rotation)),t.depth>=this.options.size){let r=2;1!==t.rotation&&-1!==t.rotation||(r=-1*t.rotation);const e=function(t){const{target:r}=t;switch(r){case"U":return"D";case"L":return"R";case"F":return"B";case"R":return"L";case"B":return"F";case"D":return"U"}}(t);this.state[e]=R(this.state[e],r)}switch(r){case"U":!function(t,r){const n=U(t);L(r,(s,o,i)=>{const a=e(n.B.r,i),u=e(n.R.r,i),h=e(n.F.r,i),f=e(n.L.r,i);let D,B,L,R;2===r.rotation?(D=h,B=f,L=a,R=u):-1===r.rotation?(D=u,B=h,L=f,R=a):(D=f,B=a,L=u,R=h),c(n.B.r,i,1,D),c(n.R.r,i,1,B),c(n.F.r,i,1,L),c(n.L.r,i,1,R),t.B=l(n.B.r),t.R=l(n.R.r),t.F=l(n.F.r),t.L=l(n.L.r)})}(this.state,t);break;case"L":!function(t,r){const n=U(t);L(r,(s,i,a)=>{const u=e(n.U.c,a),h=e(n.F.c,a),f=e(n.D.c,a),l=e(n.B.c,i);let B,L,R,U;2===r.rotation?(B=f,L=o(l),R=u,U=o(h)):-1===r.rotation?(B=h,L=f,R=o(l),U=o(u)):(B=o(l),L=u,R=h,U=o(f)),c(n.U.c,a,1,B),c(n.F.c,a,1,L),c(n.D.c,a,1,R),c(n.B.c,i,1,U),t.U=D(n.U.c),t.F=D(n.F.c),t.D=D(n.D.c),t.B=D(n.B.c)})}(this.state,t);break;case"F":!function(t,r){const n=U(t);L(r,(s,i,a)=>{const u=e(n.U.r,i),h=e(n.R.c,a),f=e(n.D.r,a),B=e(n.L.c,i);let L,R,U,F;2===r.rotation?(L=o(f),R=o(B),U=o(u),F=o(h)):-1===r.rotation?(L=h,R=o(f),U=B,F=o(u)):(L=o(B),R=u,U=o(h),F=f),c(n.U.r,i,1,L),c(n.R.c,a,1,R),c(n.D.r,a,1,U),c(n.L.c,i,1,F),t.U=l(n.U.r),t.R=D(n.R.c),t.D=l(n.D.r),t.L=D(n.L.c)})}(this.state,t);break;case"R":!function(t,r){const n=U(t);L(r,(s,i,a)=>{const u=e(n.U.c,i),h=e(n.B.c,a),f=e(n.D.c,i),l=e(n.F.c,i);let B,L,R,U;2===r.rotation?(B=f,L=o(l),R=u,U=o(h)):-1===r.rotation?(B=o(h),L=o(f),R=l,U=u):(B=l,L=o(u),R=o(h),U=f),c(n.U.c,i,1,B),c(n.B.c,a,1,L),c(n.D.c,i,1,R),c(n.F.c,i,1,U),t.U=D(n.U.c),t.B=D(n.B.c),t.D=D(n.D.c),t.F=D(n.F.c)})}(this.state,t);break;case"B":!function(t,r){const n=U(t);L(r,(s,i,a)=>{const u=e(n.U.r,a),h=e(n.L.c,a),f=e(n.D.r,i),B=e(n.R.c,i);let L,R,U,F;2===r.rotation?(L=o(f),R=o(B),U=o(u),F=o(h)):-1===r.rotation?(L=o(h),R=f,U=o(B),F=u):(L=B,R=o(u),U=h,F=o(f)),c(n.U.r,s-1,1,L),c(n.L.c,s-1,1,R),c(n.D.r,i,1,U),c(n.R.c,i,1,F),t.U=l(n.U.r),t.L=D(n.L.c),t.D=l(n.D.r),t.R=D(n.R.c)})}(this.state,t);break;case"D":!function(t,r){const n=U(t);L(r,(s,o)=>{const i=e(n.F.r,o),a=e(n.R.r,o),u=e(n.B.r,o),h=e(n.L.r,o);let f,D,B,L;2===r.rotation?(f=u,D=h,B=i,L=a):-1===r.rotation?(f=a,D=u,B=h,L=i):(f=h,D=i,B=a,L=u),c(n.F.r,o,1,f),c(n.R.r,o,1,D),c(n.B.r,o,1,B),c(n.L.r,o,1,L),t.F=l(n.F.r),t.R=l(n.R.r),t.B=l(n.B.r),t.L=l(n.L.r)})}(this.state,t)}}}generateScramble(t=Math.max(20,Math.pow(this.options.size,3))){const e=["U","L","F","R","B","D"],n=Math.floor(this.options.size/2),o=[],i={U:["L","F","R","B"],L:["U","F","D","B"],F:["L","U","R","D"],R:["U","B","D","F"],B:["U","L","D","R"],D:["F","R","B","L"]};for(let r=0,n=s(e);r<t;r++)n=s(i[n]),o.push(n);return o.map(t=>function(t){let r="";t.depth>1&&!t.wide?r=2:t.depth>2&&(r=t.depth);let e=t.wide?"w":"",n="";return-1===t.rotation?n="-":2===t.rotation&&(n=2),`${r}${t.target.toUpperCase()}${e}${n}`}({depth:this.options.size>3?r(0,n):1,rotation:s([-1,1,2]),target:t,wide:this.options.size>3&&!!r(0,1)})).join(" ")}isSolved(){return f(this.state.U)&&f(this.state.L)&&f(this.state.F)&&f(this.state.R)&&f(this.state.B)&&f(this.state.D)}parseTurn(t){return function(t){const r=t.match(/^(\d)*([ulfrbdxyzULFRBDXYZ]){1}(w)*(['-2])*$/);if(null===r)throw new Error(`Invalid turn: ${t}`);const e=r[4],n=r[2],s=Boolean(r[3]);let o=r[1]?parseInt(r[1],10):1;s&&(o=Math.max(2,o));let i=1;return"-"===e||"'"===e?i=-1:"2"===e&&(i=2),{depth:o,rotation:i,target:n,wide:s}}(t)}reset(){const t=Math.pow(this.options.size,2);this.state={U:h(0,t),L:h(1,t),F:h(2,t),R:h(3,t),B:h(4,t),D:h(5,t)}}},t.Dodecaminx=class extends d{constructor(t){if(!Number.isInteger(t.size))throw new Error("Dodecaminx size must be an integer");if(t.size<2)throw new Error("Dodecaminx size must be two or greater");super(t)}applyTurn(t){}generateScramble(t){return""}isSolved(){return!1}parseTurn(t){return{}}reset(){Math.pow(this.options.size,2);this.state={U:[],F:[],R:[],L:[],BR:[],BL:[],D:[],DR:[],DL:[],DBR:[],DBL:[],B:[]}}},t}({});
